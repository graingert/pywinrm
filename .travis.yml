# automatically generated by update-travis-yml.py
after_success: coveralls
before_install:
  - |
    if [[ -n "${INSTALL_LINUXBREW}" ]]; then
      git clone https://github.com/Linuxbrew/brew.git ~/.linuxbrew
      export HOMEBREW_FORCE_VENDOR_RUBY=1
      eval $(~/.linuxbrew/bin/brew shellenv)
    fi
  - |
    if [[ -n "${INSTALL_OPENSSL}" ]]; then
      brew install openssl@1.1
      ssldir=$(brew --prefix openssl@1.1 2>/dev/null || true)
      export PKG_CONFIG_PATH="${ssldir}/lib/pkgconfig${PKG_CONFIG_PATH:+:$PKG_CONFIG_PATH}"
      export LDFLAGS="-L${ssldir}/lib"
      export LD_LIBRARY_PATH="${ssldir}/lib${LD_LIBRARY_PATH:+:$LD_LIBRARY_PATH}"
      export CFLAGS="-I${ssldir}/include"
      export CPPFLAGS="-I${ssldir}/include"
    fi
  - |
    if [[ -n "${PYENV_VERSION}" ]]; then
      export PYENV_ROOT="${HOME}/.travis-pyenv"
      source <(curl -SL https://git.io/fhPYW -o -)
    fi
cache:
  - pip
  - directories:
      - $HOME/.pyenv_cache
install:
  - 'pip install coveralls'
  - 'pip install .[credssp]'
  - 'pip install .[kerberos]'
  - 'pip install -r requirements-test.txt'
language: generic
matrix:
  include:
    - language: generic
      os: linux
      dist: xenial
      env: PYENV_VERSION=2.7.15
      sudo: false
    - language: generic
      os: linux
      dist: xenial
      env: PYENV_VERSION=3.4.9
      sudo: false
    - language: generic
      os: linux
      dist: xenial
      env: PYENV_VERSION=3.5.6
      sudo: false
    - language: generic
      os: linux
      dist: xenial
      env: PYENV_VERSION=3.6.8
      sudo: false
    - language: generic
      os: linux
      dist: xenial
      env: PYENV_VERSION=3.7.2
      sudo: false
    - language: generic
      os: linux
      dist: xenial
      env: PYENV_VERSION=pypy2.7-6.0.0
      sudo: false
    - language: generic
      os: linux
      dist: xenial
      env: PYENV_VERSION=pypy3.5-6.0.0
      sudo: false
    - language: generic
      os: linux
      dist: trusty
      env: PYENV_VERSION=2.7.15
      sudo: false
    - language: generic
      os: linux
      dist: trusty
      env: PYENV_VERSION=3.4.9
      sudo: false
    - language: generic
      os: linux
      dist: trusty
      env: PYENV_VERSION=3.5.6
      sudo: false
    - language: generic
      os: linux
      dist: trusty
      env: PYENV_VERSION=3.6.8
      sudo: false
    - language: generic
      os: linux
      dist: trusty
      env: 'PYENV_VERSION=3.7.2 INSTALL_OPENSSL=True INSTALL_LINUXBREW=True'
      sudo: false
    - language: generic
      os: linux
      dist: trusty
      env: PYENV_VERSION=pypy2.7-6.0.0
      sudo: false
    - language: generic
      os: linux
      dist: trusty
      env: PYENV_VERSION=pypy3.5-6.0.0
      sudo: false
    - language: generic
      os: osx
      osx_image: xcode10.1
      env: PYENV_VERSION=2.7.15
    - language: generic
      os: osx
      osx_image: xcode10.1
      env: PYENV_VERSION=3.4.9
    - language: generic
      os: osx
      osx_image: xcode10.1
      env: PYENV_VERSION=3.5.6
    - language: generic
      os: osx
      osx_image: xcode10.1
      env: PYENV_VERSION=3.6.8
    - language: generic
      os: osx
      osx_image: xcode10.1
      env: PYENV_VERSION=3.7.2
    - language: generic
      os: osx
      osx_image: xcode10.1
      env: 'PYENV_VERSION=pypy2.7-6.0.0 INSTALL_OPENSSL=True'
    - language: generic
      os: osx
      osx_image: xcode10.1
      env: 'PYENV_VERSION=pypy3.5-6.0.0 INSTALL_OPENSSL=True'
    - language: generic
      os: osx
      osx_image: xcode9.4
      env: PYENV_VERSION=2.7.15
    - language: generic
      os: osx
      osx_image: xcode9.4
      env: PYENV_VERSION=3.4.9
    - language: generic
      os: osx
      osx_image: xcode9.4
      env: PYENV_VERSION=3.5.6
    - language: generic
      os: osx
      osx_image: xcode9.4
      env: PYENV_VERSION=3.6.8
    - language: generic
      os: osx
      osx_image: xcode9.4
      env: PYENV_VERSION=3.7.2
    - language: generic
      os: osx
      osx_image: xcode9.4
      env: 'PYENV_VERSION=pypy2.7-6.0.0 INSTALL_OPENSSL=True'
    - language: generic
      os: osx
      osx_image: xcode9.4
      env: 'PYENV_VERSION=pypy3.5-6.0.0 INSTALL_OPENSSL=True'
    - language: generic
      os: osx
      osx_image: xcode8.3
      env: PYENV_VERSION=2.7.15
    - language: generic
      os: osx
      osx_image: xcode8.3
      env: PYENV_VERSION=3.4.9
    - language: generic
      os: osx
      osx_image: xcode8.3
      env: PYENV_VERSION=3.5.6
    - language: generic
      os: osx
      osx_image: xcode8.3
      env: PYENV_VERSION=3.6.8
    - language: generic
      os: osx
      osx_image: xcode8.3
      env: PYENV_VERSION=3.7.2
    - language: generic
      os: osx
      osx_image: xcode8.3
      env: 'PYENV_VERSION=pypy2.7-6.0.0 INSTALL_OPENSSL=True'
    - language: generic
      os: osx
      osx_image: xcode8.3
      env: 'PYENV_VERSION=pypy3.5-6.0.0 INSTALL_OPENSSL=True'
script: 'py.test -v --pep8 --cov=winrm --cov-report=term-missing winrm/tests/'
